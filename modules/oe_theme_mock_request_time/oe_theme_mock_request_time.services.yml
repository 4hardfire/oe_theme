services:
  # Overrides Drupal core's "cache.backend.chainedfast" service.
  # @see https://www.drupal.org/docs/8/api/services-and-dependency-injection/altering-existing-services-providing-dynamic-services
  cache.backend.chainedfast:
    class: Drupal\Core\Cache\ChainedFastBackendFactory
    arguments: ['@settings', 'cache.backend.oe_theme_mock_request_time', 'cache.backend.oe_theme_mock_request_time']
    calls:
      - [setContainer, ['@service_container']]

  # Overrides Drupal core's "datetime.time" service.
  # @see https://www.drupal.org/docs/8/api/services-and-dependency-injection/altering-existing-services-providing-dynamic-services
  datetime.time:
    class: Drupal\oe_theme_mock_request_time\Time
    arguments: ['@oe_theme_mock_request_time.request_time_manager', '@request_stack']

  cache.backend.oe_theme_mock_request_time:
    class: Drupal\oe_theme_mock_request_time\TestCacheBackendFactory
    arguments: ['@oe_theme_mock_request_time.request_time_manager', '@database', '@cache_tags.invalidator.checksum', '@settings']

  oe_theme_mock_request_time.request_time_manager:
    class: Drupal\oe_theme_mock_request_time\MockRequestTimeManager
    arguments: ['@state']
